<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
    </head>
    <body style="height: 100vh; overflow: hidden; margin: 0; padding: 0">
        <iframe
            id="timetable"
            src="loading.html"
            style="
                width: 100%;
                height: 100%;
                border: 0;
                margin: 0;
                padding: 0;
                overflow: hidden;
            "
        ></iframe>
        <script>
            function sleep(msec) {
                return new Promise((r) => setTimeout(r, msec));
            }

            window.onload = async () => {
                const p = new URLSearchParams(window.location.search);
                let u = p.get("u") ? +p.get("u") : NaN;
                while (true) {
                    const now = new Date();
                    const frame = document.getElementById("timetable");
                    frame.src = `/timetable?timestamp=${Math.floor(now.getTime() / 1000)}`;
                    if (isNaN(u)) return;
                    await sleep(u);
                }
            };
        </script>
    </body>
</html>
